require=function(){function d(s,a,o){function u(r,e){if(!a[r]){if(!s[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(l)return l(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var n=a[r]={exports:{}};s[r][0].call(n.exports,function(e){var t=s[r][1][e];return u(t||e)},n,n.exports,d,s,a,o)}return a[r].exports}for(var l="function"==typeof require&&require,e=0;e<o.length;e++)u(o[e]);return u}return d}()({lunr:[function(e,r,i){(function(){var C=function(e){var t=new C.Builder;t.pipeline.add(C.trimmer,C.stopWordFilter,C.stemmer);t.searchPipeline.add(C.stemmer);e.call(t,t);return t.build()};C.version="2.1.6";C.utils={};C.utils.warn=function(t){return function(e){if(t.console&&console.warn){console.warn(e)}}}(this);C.utils.asString=function(e){if(e===void 0||e===null){return""}else{return e.toString()}};C.FieldRef=function(e,t,r){this.docRef=e;this.fieldName=t;this._stringValue=r};C.FieldRef.joiner="/";C.FieldRef.fromString=function(e){var t=e.indexOf(C.FieldRef.joiner);if(t===-1){throw"malformed field ref string"}var r=e.slice(0,t),i=e.slice(t+1);return new C.FieldRef(i,r,e)};C.FieldRef.prototype.toString=function(){if(this._stringValue==undefined){this._stringValue=this.fieldName+C.FieldRef.joiner+this.docRef}return this._stringValue};C.idf=function(e,t){var r=0;for(var i in e){if(i=="_index")continue;r+=Object.keys(e[i]).length}var n=(t-r+.5)/(r+.5);return Math.log(1+Math.abs(n))};C.Token=function(e,t){this.str=e||"";this.metadata=t||{}};C.Token.prototype.toString=function(){return this.str};C.Token.prototype.update=function(e){this.str=e(this.str,this.metadata);return this};C.Token.prototype.clone=function(e){e=e||function(e){return e};return new C.Token(e(this.str,this.metadata),this.metadata)};C.tokenizer=function(e){if(e==null||e==undefined){return[]}if(Array.isArray(e)){return e.map(function(e){return new C.Token(C.utils.asString(e).toLowerCase())})}var t=e.toString().trim().toLowerCase(),r=t.length,i=[];for(var n=0,s=0;n<=r;n++){var a=t.charAt(n),o=n-s;if(a.match(C.tokenizer.separator)||n==r){if(o>0){i.push(new C.Token(t.slice(s,n),{position:[s,o],index:i.length}))}s=n+1}}return i};C.tokenizer.separator=/[\s\-]+/;C.Pipeline=function(){this._stack=[]};C.Pipeline.registeredFunctions=Object.create(null);C.Pipeline.registerFunction=function(e,t){if(t in this.registeredFunctions){C.utils.warn("Overwriting existing registered function: "+t)}e.label=t;C.Pipeline.registeredFunctions[e.label]=e};C.Pipeline.warnIfFunctionNotRegistered=function(e){var t=e.label&&e.label in this.registeredFunctions;if(!t){C.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",e)}};C.Pipeline.load=function(e){var r=new C.Pipeline;e.forEach(function(e){var t=C.Pipeline.registeredFunctions[e];if(t){r.add(t)}else{throw new Error("Cannot load unregistered function: "+e)}});return r};C.Pipeline.prototype.add=function(){var e=Array.prototype.slice.call(arguments);e.forEach(function(e){C.Pipeline.warnIfFunctionNotRegistered(e);this._stack.push(e)},this)};C.Pipeline.prototype.after=function(e,t){C.Pipeline.warnIfFunctionNotRegistered(t);var r=this._stack.indexOf(e);if(r==-1){throw new Error("Cannot find existingFn")}r=r+1;this._stack.splice(r,0,t)};C.Pipeline.prototype.before=function(e,t){C.Pipeline.warnIfFunctionNotRegistered(t);var r=this._stack.indexOf(e);if(r==-1){throw new Error("Cannot find existingFn")}this._stack.splice(r,0,t)};C.Pipeline.prototype.remove=function(e){var t=this._stack.indexOf(e);if(t==-1){return}this._stack.splice(t,1)};C.Pipeline.prototype.run=function(e){var t=this._stack.length;for(var r=0;r<t;r++){var i=this._stack[r];var n=[];for(var s=0;s<e.length;s++){var a=i(e[s],s,e);if(a===void 0||a==="")continue;if(a instanceof Array){for(var o=0;o<a.length;o++){n.push(a[o])}}else{n.push(a)}}e=n}return e};C.Pipeline.prototype.runString=function(e){var t=new C.Token(e);return this.run([t]).map(function(e){return e.toString()})};C.Pipeline.prototype.reset=function(){this._stack=[]};C.Pipeline.prototype.toJSON=function(){return this._stack.map(function(e){C.Pipeline.warnIfFunctionNotRegistered(e);return e.label})};C.Vector=function(e){this._magnitude=0;this.elements=e||[]};C.Vector.prototype.positionForIndex=function(e){if(this.elements.length==0){return 0}var t=0,r=this.elements.length/2,i=r-t,n=Math.floor(i/2),s=this.elements[n*2];while(i>1){if(s<e){t=n}if(s>e){r=n}if(s==e){break}i=r-t;n=t+Math.floor(i/2);s=this.elements[n*2]}if(s==e){return n*2}if(s>e){return n*2}if(s<e){return(n+1)*2}};C.Vector.prototype.insert=function(e,t){this.upsert(e,t,function(){throw"duplicate index"})};C.Vector.prototype.upsert=function(e,t,r){this._magnitude=0;var i=this.positionForIndex(e);if(this.elements[i]==e){this.elements[i+1]=r(this.elements[i+1],t)}else{this.elements.splice(i,0,e,t)}};C.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;var e=0,t=this.elements.length;for(var r=1;r<t;r+=2){var i=this.elements[r];e+=i*i}return this._magnitude=Math.sqrt(e)};C.Vector.prototype.dot=function(e){var t=0,r=this.elements,i=e.elements,n=r.length,s=i.length,a=0,o=0,u=0,l=0;while(u<n&&l<s){a=r[u],o=i[l];if(a<o){u+=2}else if(a>o){l+=2}else if(a==o){t+=r[u+1]*i[l+1];u+=2;l+=2}}return t};C.Vector.prototype.similarity=function(e){return this.dot(e)/(this.magnitude()*e.magnitude())};C.Vector.prototype.toArray=function(){var e=new Array(this.elements.length/2);for(var t=1,r=0;t<this.elements.length;t+=2,r++){e[r]=this.elements[t]}return e};C.Vector.prototype.toJSON=function(){return this.elements};C.stemmer=function(){var d={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},h={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},e="[^aeiou]",t="[aeiouy]",r=e+"[^aeiouy]*",i=t+"[aeiou]*",n="^("+r+")?"+i+r,s="^("+r+")?"+i+r+"("+i+")?$",a="^("+r+")?"+i+r+i+r,o="^("+r+")?"+t;var f=new RegExp(n);var c=new RegExp(a);var p=new RegExp(s);var y=new RegExp(o);var v=/^(.+?)(ss|i)es$/;var m=/^(.+?)([^s])s$/;var g=/^(.+?)eed$/;var x=/^(.+?)(ed|ing)$/;var w=/.$/;var k=/(at|bl|iz)$/;var Q=new RegExp("([^aeiouylsz])\\1$");var L=new RegExp("^"+r+t+"[^aeiouwxy]$");var T=/^(.+?[^aeiou])y$/;var S=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;var b=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;var P=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;var E=/^(.+?)(s|t)(ion)$/;var O=/^(.+?)e$/;var I=/ll$/;var F=new RegExp("^"+r+t+"[^aeiouwxy]$");var u=function e(t){var r,i,n,s,a,o,u;if(t.length<3){return t}n=t.substr(0,1);if(n=="y"){t=n.toUpperCase()+t.substr(1)}s=v;a=m;if(s.test(t)){t=t.replace(s,"$1$2")}else if(a.test(t)){t=t.replace(a,"$1$2")}s=g;a=x;if(s.test(t)){var l=s.exec(t);s=f;if(s.test(l[1])){s=w;t=t.replace(s,"")}}else if(a.test(t)){var l=a.exec(t);r=l[1];a=y;if(a.test(r)){t=r;a=k;o=Q;u=L;if(a.test(t)){t=t+"e"}else if(o.test(t)){s=w;t=t.replace(s,"")}else if(u.test(t)){t=t+"e"}}}s=T;if(s.test(t)){var l=s.exec(t);r=l[1];t=r+"i"}s=S;if(s.test(t)){var l=s.exec(t);r=l[1];i=l[2];s=f;if(s.test(r)){t=r+d[i]}}s=b;if(s.test(t)){var l=s.exec(t);r=l[1];i=l[2];s=f;if(s.test(r)){t=r+h[i]}}s=P;a=E;if(s.test(t)){var l=s.exec(t);r=l[1];s=c;if(s.test(r)){t=r}}else if(a.test(t)){var l=a.exec(t);r=l[1]+l[2];a=c;if(a.test(r)){t=r}}s=O;if(s.test(t)){var l=s.exec(t);r=l[1];s=c;a=p;o=F;if(s.test(r)||a.test(r)&&!o.test(r)){t=r}}s=I;a=c;if(s.test(t)&&a.test(t)){s=w;t=t.replace(s,"")}if(n=="y"){t=n.toLowerCase()+t.substr(1)}return t};return function(e){return e.update(u)}}();C.Pipeline.registerFunction(C.stemmer,"stemmer");C.generateStopWordFilter=function(e){var t=e.reduce(function(e,t){e[t]=t;return e},{});return function(e){if(e&&t[e.toString()]!==e.toString())return e}};C.stopWordFilter=C.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]);C.Pipeline.registerFunction(C.stopWordFilter,"stopWordFilter");C.trimmer=function(e){return e.update(function(e){return e.replace(/^\W+/,"").replace(/\W+$/,"")})};C.Pipeline.registerFunction(C.trimmer,"trimmer");C.TokenSet=function(){this.final=false;this.edges={};this.id=C.TokenSet._nextId;C.TokenSet._nextId+=1};C.TokenSet._nextId=1;C.TokenSet.fromArray=function(e){var t=new C.TokenSet.Builder;for(var r=0,i=e.length;r<i;r++){t.insert(e[r])}t.finish();return t.root};C.TokenSet.fromClause=function(e){if("editDistance"in e){return C.TokenSet.fromFuzzyString(e.term,e.editDistance)}else{return C.TokenSet.fromString(e.term)}};C.TokenSet.fromFuzzyString=function(e,t){var r=new C.TokenSet;var i=[{node:r,editsRemaining:t,str:e}];while(i.length){var n=i.pop();if(n.str.length>0){var s=n.str.charAt(0),a;if(s in n.node.edges){a=n.node.edges[s]}else{a=new C.TokenSet;n.node.edges[s]=a}if(n.str.length==1){a.final=true}else{i.push({node:a,editsRemaining:n.editsRemaining,str:n.str.slice(1)})}}if(n.editsRemaining>0&&n.str.length>1){var s=n.str.charAt(1),o;if(s in n.node.edges){o=n.node.edges[s]}else{o=new C.TokenSet;n.node.edges[s]=o}if(n.str.length<=2){o.final=true}else{i.push({node:o,editsRemaining:n.editsRemaining-1,str:n.str.slice(2)})}}if(n.editsRemaining>0&&n.str.length==1){n.node.final=true}if(n.editsRemaining>0&&n.str.length>=1){if("*"in n.node.edges){var u=n.node.edges["*"]}else{var u=new C.TokenSet;n.node.edges["*"]=u}if(n.str.length==1){u.final=true}else{i.push({node:u,editsRemaining:n.editsRemaining-1,str:n.str.slice(1)})}}if(n.editsRemaining>0){if("*"in n.node.edges){var l=n.node.edges["*"]}else{var l=new C.TokenSet;n.node.edges["*"]=l}if(n.str.length==0){l.final=true}else{i.push({node:l,editsRemaining:n.editsRemaining-1,str:n.str})}}if(n.editsRemaining>0&&n.str.length>1){var d=n.str.charAt(0),h=n.str.charAt(1),f;if(h in n.node.edges){f=n.node.edges[h]}else{f=new C.TokenSet;n.node.edges[h]=f}if(n.str.length==1){f.final=true}else{i.push({node:f,editsRemaining:n.editsRemaining-1,str:d+n.str.slice(2)})}}}return r};C.TokenSet.fromString=function(e){var t=new C.TokenSet,r=t,i=false;for(var n=0,s=e.length;n<s;n++){var a=e[n],o=n==s-1;if(a=="*"){i=true;t.edges[a]=t;t.final=o}else{var u=new C.TokenSet;u.final=o;t.edges[a]=u;t=u;if(i){t.edges["*"]=r}}}return r};C.TokenSet.prototype.toArray=function(){var e=[];var t=[{prefix:"",node:this}];while(t.length){var r=t.pop(),i=Object.keys(r.node.edges),n=i.length;if(r.node.final){e.push(r.prefix)}for(var s=0;s<n;s++){var a=i[s];t.push({prefix:r.prefix.concat(a),node:r.node.edges[a]})}}return e};C.TokenSet.prototype.toString=function(){if(this._str){return this._str}var e=this.final?"1":"0",t=Object.keys(this.edges).sort(),r=t.length;for(var i=0;i<r;i++){var n=t[i],s=this.edges[n];e=e+n+s.id}return e};C.TokenSet.prototype.intersect=function(e){var t=new C.TokenSet,r=undefined;var i=[{qNode:e,output:t,node:this}];while(i.length){r=i.pop();var n=Object.keys(r.qNode.edges),s=n.length,a=Object.keys(r.node.edges),o=a.length;for(var u=0;u<s;u++){var l=n[u];for(var d=0;d<o;d++){var h=a[d];if(h==l||l=="*"){var f=r.node.edges[h],c=r.qNode.edges[l],p=f.final&&c.final,y=undefined;if(h in r.output.edges){y=r.output.edges[h];y.final=y.final||p}else{y=new C.TokenSet;y.final=p;r.output.edges[h]=y}i.push({qNode:c,output:y,node:f})}}}}return t};C.TokenSet.Builder=function(){this.previousWord="";this.root=new C.TokenSet;this.uncheckedNodes=[];this.minimizedNodes={}};C.TokenSet.Builder.prototype.insert=function(e){var t,r=0;if(e<this.previousWord){throw new Error("Out of order word insertion")}for(var i=0;i<e.length&&i<this.previousWord.length;i++){if(e[i]!=this.previousWord[i])break;r++}this.minimize(r);if(this.uncheckedNodes.length==0){t=this.root}else{t=this.uncheckedNodes[this.uncheckedNodes.length-1].child}for(var i=r;i<e.length;i++){var n=new C.TokenSet,s=e[i];t.edges[s]=n;this.uncheckedNodes.push({parent:t,char:s,child:n});t=n}t.final=true;this.previousWord=e};C.TokenSet.Builder.prototype.finish=function(){this.minimize(0)};C.TokenSet.Builder.prototype.minimize=function(e){for(var t=this.uncheckedNodes.length-1;t>=e;t--){var r=this.uncheckedNodes[t],i=r.child.toString();if(i in this.minimizedNodes){r.parent.edges[r.char]=this.minimizedNodes[i]}else{r.child._str=i;this.minimizedNodes[i]=r.child}this.uncheckedNodes.pop()}};C.Index=function(e){this.invertedIndex=e.invertedIndex;this.fieldVectors=e.fieldVectors;this.tokenSet=e.tokenSet;this.fields=e.fields;this.pipeline=e.pipeline};C.Index.prototype.search=function(r){return this.query(function(e){var t=new C.QueryParser(r,e);t.parse()})};C.Index.prototype.query=function(e){var t=new C.Query(this.fields),r=Object.create(null),i=Object.create(null),n=Object.create(null);e.call(t,t);for(var s=0;s<t.clauses.length;s++){var a=t.clauses[s],o=null;if(a.usePipeline){o=this.pipeline.runString(a.term)}else{o=[a.term]}for(var u=0;u<o.length;u++){var l=o[u];a.term=l;var d=C.TokenSet.fromClause(a),h=this.tokenSet.intersect(d).toArray();for(var f=0;f<h.length;f++){var c=h[f],p=this.invertedIndex[c],y=p._index;for(var v=0;v<a.fields.length;v++){var m=a.fields[v],g=p[m],x=Object.keys(g),w=c+"/"+m;if(i[m]===undefined){i[m]=new C.Vector}i[m].upsert(y,1*a.boost,function(e,t){return e+t});if(n[w]){continue}for(var k=0;k<x.length;k++){var Q=x[k],L=new C.FieldRef(Q,m),T=g[Q],S;if((S=r[L])===undefined){r[L]=new C.MatchData(c,m,T)}else{S.add(c,m,T)}}n[w]=true}}}}var b=Object.keys(r),P=[],E=Object.create(null);for(var s=0;s<b.length;s++){var O=C.FieldRef.fromString(b[s]),I=O.docRef,F=this.fieldVectors[O],_=i[O.fieldName].similarity(F),R;if((R=E[I])!==undefined){R.score+=_;R.matchData.combine(r[O])}else{var N={ref:I,score:_,matchData:r[O]};E[I]=N;P.push(N)}}return P.sort(function(e,t){return t.score-e.score})};C.Index.prototype.toJSON=function(){var e=Object.keys(this.invertedIndex).sort().map(function(e){return[e,this.invertedIndex[e]]},this);var t=Object.keys(this.fieldVectors).map(function(e){return[e,this.fieldVectors[e].toJSON()]},this);return{version:C.version,fields:this.fields,fieldVectors:t,invertedIndex:e,pipeline:this.pipeline.toJSON()}};C.Index.load=function(e){var t={},r={},i=e.fieldVectors,n={},s=e.invertedIndex,a=new C.TokenSet.Builder,o=C.Pipeline.load(e.pipeline);if(e.version!=C.version){C.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+C.version+"' does not match serialized index '"+e.version+"'")}for(var u=0;u<i.length;u++){var l=i[u],d=l[0],h=l[1];r[d]=new C.Vector(h)}for(var u=0;u<s.length;u++){var l=s[u],f=l[0],c=l[1];a.insert(f);n[f]=c}a.finish();t.fields=e.fields;t.fieldVectors=r;t.invertedIndex=n;t.tokenSet=a.root;t.pipeline=o;return new C.Index(t)};C.Builder=function(){this._ref="id";this._fields=[];this.invertedIndex=Object.create(null);this.fieldTermFrequencies={};this.fieldLengths={};this.tokenizer=C.tokenizer;this.pipeline=new C.Pipeline;this.searchPipeline=new C.Pipeline;this.documentCount=0;this._b=.75;this._k1=1.2;this.termIndex=0;this.metadataWhitelist=[]};C.Builder.prototype.ref=function(e){this._ref=e};C.Builder.prototype.field=function(e){this._fields.push(e)};C.Builder.prototype.b=function(e){if(e<0){this._b=0}else if(e>1){this._b=1}else{this._b=e}};C.Builder.prototype.k1=function(e){this._k1=e};C.Builder.prototype.add=function(e){var t=e[this._ref];this.documentCount+=1;for(var r=0;r<this._fields.length;r++){var i=this._fields[r],n=e[i],s=this.tokenizer(n),a=this.pipeline.run(s),o=new C.FieldRef(t,i),u=Object.create(null);this.fieldTermFrequencies[o]=u;this.fieldLengths[o]=0;this.fieldLengths[o]+=a.length;for(var l=0;l<a.length;l++){var d=a[l];if(u[d]==undefined){u[d]=0}u[d]+=1;if(this.invertedIndex[d]==undefined){var h=Object.create(null);h["_index"]=this.termIndex;this.termIndex+=1;for(var f=0;f<this._fields.length;f++){h[this._fields[f]]=Object.create(null)}this.invertedIndex[d]=h}if(this.invertedIndex[d][i][t]==undefined){this.invertedIndex[d][i][t]=Object.create(null)}for(var c=0;c<this.metadataWhitelist.length;c++){var p=this.metadataWhitelist[c],y=d.metadata[p];if(this.invertedIndex[d][i][t][p]==undefined){this.invertedIndex[d][i][t][p]=[]}this.invertedIndex[d][i][t][p].push(y)}}}};C.Builder.prototype.calculateAverageFieldLengths=function(){var e=Object.keys(this.fieldLengths),t=e.length,r={},i={};for(var n=0;n<t;n++){var s=C.FieldRef.fromString(e[n]),a=s.fieldName;i[a]||(i[a]=0);i[a]+=1;r[a]||(r[a]=0);r[a]+=this.fieldLengths[s]}for(var n=0;n<this._fields.length;n++){var a=this._fields[n];r[a]=r[a]/i[a]}this.averageFieldLength=r};C.Builder.prototype.createFieldVectors=function(){var e={},t=Object.keys(this.fieldTermFrequencies),r=t.length,i=Object.create(null);for(var n=0;n<r;n++){var s=C.FieldRef.fromString(t[n]),a=s.fieldName,o=this.fieldLengths[s],u=new C.Vector,l=this.fieldTermFrequencies[s],d=Object.keys(l),h=d.length;for(var f=0;f<h;f++){var c=d[f],p=l[c],y=this.invertedIndex[c]._index,v,m,g;if(i[c]===undefined){v=C.idf(this.invertedIndex[c],this.documentCount);i[c]=v}else{v=i[c]}m=v*((this._k1+1)*p)/(this._k1*(1-this._b+this._b*(o/this.averageFieldLength[a]))+p);g=Math.round(m*1e3)/1e3;u.insert(y,g)}e[s]=u}this.fieldVectors=e};C.Builder.prototype.createTokenSet=function(){this.tokenSet=C.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())};C.Builder.prototype.build=function(){this.calculateAverageFieldLengths();this.createFieldVectors();this.createTokenSet();return new C.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:this._fields,pipeline:this.searchPipeline})};C.Builder.prototype.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this);e.apply(this,t)};C.MatchData=function(e,t,r){var i=Object.create(null),n=Object.keys(r);for(var s=0;s<n.length;s++){var a=n[s];i[a]=r[a].slice()}this.metadata=Object.create(null);this.metadata[e]=Object.create(null);this.metadata[e][t]=i};C.MatchData.prototype.combine=function(e){var t=Object.keys(e.metadata);for(var r=0;r<t.length;r++){var i=t[r],n=Object.keys(e.metadata[i]);if(this.metadata[i]==undefined){this.metadata[i]=Object.create(null)}for(var s=0;s<n.length;s++){var a=n[s],o=Object.keys(e.metadata[i][a]);if(this.metadata[i][a]==undefined){this.metadata[i][a]=Object.create(null)}for(var u=0;u<o.length;u++){var l=o[u];if(this.metadata[i][a][l]==undefined){this.metadata[i][a][l]=e.metadata[i][a][l]}else{this.metadata[i][a][l]=this.metadata[i][a][l].concat(e.metadata[i][a][l])}}}}};C.MatchData.prototype.add=function(e,t,r){if(!(e in this.metadata)){this.metadata[e]=Object.create(null);this.metadata[e][t]=r;return}if(!(t in this.metadata[e])){this.metadata[e][t]=r;return}var i=Object.keys(r);for(var n=0;n<i.length;n++){var s=i[n];if(s in this.metadata[e][t]){this.metadata[e][t][s]=this.metadata[e][t][s].concat(r[s])}else{this.metadata[e][t][s]=r[s]}}};C.Query=function(e){this.clauses=[];this.allFields=e};C.Query.wildcard=new String("*");C.Query.wildcard.NONE=0;C.Query.wildcard.LEADING=1;C.Query.wildcard.TRAILING=2;C.Query.prototype.clause=function(e){if(!("fields"in e)){e.fields=this.allFields}if(!("boost"in e)){e.boost=1}if(!("usePipeline"in e)){e.usePipeline=true}if(!("wildcard"in e)){e.wildcard=C.Query.wildcard.NONE}if(e.wildcard&C.Query.wildcard.LEADING&&e.term.charAt(0)!=C.Query.wildcard){e.term="*"+e.term}if(e.wildcard&C.Query.wildcard.TRAILING&&e.term.slice(-1)!=C.Query.wildcard){e.term=""+e.term+"*"}this.clauses.push(e);return this};C.Query.prototype.term=function(e,t){var r=t||{};r.term=e;this.clause(r);return this};C.QueryParseError=function(e,t,r){this.name="QueryParseError";this.message=e;this.start=t;this.end=r};C.QueryParseError.prototype=new Error;C.QueryLexer=function(e){this.lexemes=[];this.str=e;this.length=e.length;this.pos=0;this.start=0;this.escapeCharPositions=[]};C.QueryLexer.prototype.run=function(){var e=C.QueryLexer.lexText;while(e){e=e(this)}};C.QueryLexer.prototype.sliceString=function(){var e=[],t=this.start,r=this.pos;for(var i=0;i<this.escapeCharPositions.length;i++){r=this.escapeCharPositions[i];e.push(this.str.slice(t,r));t=r+1}e.push(this.str.slice(t,this.pos));this.escapeCharPositions.length=0;return e.join("")};C.QueryLexer.prototype.emit=function(e){this.lexemes.push({type:e,str:this.sliceString(),start:this.start,end:this.pos});this.start=this.pos};C.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1);this.pos+=1};C.QueryLexer.prototype.next=function(){if(this.pos>=this.length){return C.QueryLexer.EOS}var e=this.str.charAt(this.pos);this.pos+=1;return e};C.QueryLexer.prototype.width=function(){return this.pos-this.start};C.QueryLexer.prototype.ignore=function(){if(this.start==this.pos){this.pos+=1}this.start=this.pos};C.QueryLexer.prototype.backup=function(){this.pos-=1};C.QueryLexer.prototype.acceptDigitRun=function(){var e,t;do{e=this.next();t=e.charCodeAt(0)}while(t>47&&t<58);if(e!=C.QueryLexer.EOS){this.backup()}};C.QueryLexer.prototype.more=function(){return this.pos<this.length};C.QueryLexer.EOS="EOS";C.QueryLexer.FIELD="FIELD";C.QueryLexer.TERM="TERM";C.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE";C.QueryLexer.BOOST="BOOST";C.QueryLexer.lexField=function(e){e.backup();e.emit(C.QueryLexer.FIELD);e.ignore();return C.QueryLexer.lexText};C.QueryLexer.lexTerm=function(e){if(e.width()>1){e.backup();e.emit(C.QueryLexer.TERM)}e.ignore();if(e.more()){return C.QueryLexer.lexText}};C.QueryLexer.lexEditDistance=function(e){e.ignore();e.acceptDigitRun();e.emit(C.QueryLexer.EDIT_DISTANCE);return C.QueryLexer.lexText};C.QueryLexer.lexBoost=function(e){e.ignore();e.acceptDigitRun();e.emit(C.QueryLexer.BOOST);return C.QueryLexer.lexText};C.QueryLexer.lexEOS=function(e){if(e.width()>0){e.emit(C.QueryLexer.TERM)}};C.QueryLexer.termSeparator=C.tokenizer.separator;C.QueryLexer.lexText=function(e){while(true){var t=e.next();if(t==C.QueryLexer.EOS){return C.QueryLexer.lexEOS}if(t.charCodeAt(0)==92){e.escapeCharacter();continue}if(t==":"){return C.QueryLexer.lexField}if(t=="~"){e.backup();if(e.width()>0){e.emit(C.QueryLexer.TERM)}return C.QueryLexer.lexEditDistance}if(t=="^"){e.backup();if(e.width()>0){e.emit(C.QueryLexer.TERM)}return C.QueryLexer.lexBoost}if(t.match(C.QueryLexer.termSeparator)){return C.QueryLexer.lexTerm}}};C.QueryParser=function(e,t){this.lexer=new C.QueryLexer(e);this.query=t;this.currentClause={};this.lexemeIdx=0};C.QueryParser.prototype.parse=function(){this.lexer.run();this.lexemes=this.lexer.lexemes;var e=C.QueryParser.parseFieldOrTerm;while(e){e=e(this)}return this.query};C.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]};C.QueryParser.prototype.consumeLexeme=function(){var e=this.peekLexeme();this.lexemeIdx+=1;return e};C.QueryParser.prototype.nextClause=function(){var e=this.currentClause;this.query.clause(e);this.currentClause={}};C.QueryParser.parseFieldOrTerm=function(e){var t=e.peekLexeme();if(t==undefined){return}switch(t.type){case C.QueryLexer.FIELD:return C.QueryParser.parseField;case C.QueryLexer.TERM:return C.QueryParser.parseTerm;default:var r="expected either a field or a term, found "+t.type;if(t.str.length>=1){r+=" with value '"+t.str+"'"}throw new C.QueryParseError(r,t.start,t.end)}};C.QueryParser.parseField=function(e){var t=e.consumeLexeme();if(t==undefined){return}if(e.query.allFields.indexOf(t.str)==-1){var r=e.query.allFields.map(function(e){return"'"+e+"'"}).join(", "),i="unrecognised field '"+t.str+"', possible fields: "+r;throw new C.QueryParseError(i,t.start,t.end)}e.currentClause.fields=[t.str];var n=e.peekLexeme();if(n==undefined){var i="expecting term, found nothing";throw new C.QueryParseError(i,t.start,t.end)}switch(n.type){case C.QueryLexer.TERM:return C.QueryParser.parseTerm;default:var i="expecting term, found '"+n.type+"'";throw new C.QueryParseError(i,n.start,n.end)}};C.QueryParser.parseTerm=function(e){var t=e.consumeLexeme();if(t==undefined){return}e.currentClause.term=t.str.toLowerCase();if(t.str.indexOf("*")!=-1){e.currentClause.usePipeline=false}var r=e.peekLexeme();if(r==undefined){e.nextClause();return}switch(r.type){case C.QueryLexer.TERM:e.nextClause();return C.QueryParser.parseTerm;case C.QueryLexer.FIELD:e.nextClause();return C.QueryParser.parseField;case C.QueryLexer.EDIT_DISTANCE:return C.QueryParser.parseEditDistance;case C.QueryLexer.BOOST:return C.QueryParser.parseBoost;default:var i="Unexpected lexeme type '"+r.type+"'";throw new C.QueryParseError(i,r.start,r.end)}};C.QueryParser.parseEditDistance=function(e){var t=e.consumeLexeme();if(t==undefined){return}var r=parseInt(t.str,10);if(isNaN(r)){var i="edit distance must be numeric";throw new C.QueryParseError(i,t.start,t.end)}e.currentClause.editDistance=r;var n=e.peekLexeme();if(n==undefined){e.nextClause();return}switch(n.type){case C.QueryLexer.TERM:e.nextClause();return C.QueryParser.parseTerm;case C.QueryLexer.FIELD:e.nextClause();return C.QueryParser.parseField;case C.QueryLexer.EDIT_DISTANCE:return C.QueryParser.parseEditDistance;case C.QueryLexer.BOOST:return C.QueryParser.parseBoost;default:var i="Unexpected lexeme type '"+n.type+"'";throw new C.QueryParseError(i,n.start,n.end)}};C.QueryParser.parseBoost=function(e){var t=e.consumeLexeme();if(t==undefined){return}var r=parseInt(t.str,10);if(isNaN(r)){var i="boost must be numeric";throw new C.QueryParseError(i,t.start,t.end)}e.currentClause.boost=r;var n=e.peekLexeme();if(n==undefined){e.nextClause();return}switch(n.type){case C.QueryLexer.TERM:e.nextClause();return C.QueryParser.parseTerm;case C.QueryLexer.FIELD:e.nextClause();return C.QueryParser.parseField;case C.QueryLexer.EDIT_DISTANCE:return C.QueryParser.parseEditDistance;case C.QueryLexer.BOOST:return C.QueryParser.parseBoost;default:var i="Unexpected lexeme type '"+n.type+"'";throw new C.QueryParseError(i,n.start,n.end)}};(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof i==="object"){r.exports=t()}else{e.lunr=t()}})(this,function(){return C})})()},{}]},{},[]);
